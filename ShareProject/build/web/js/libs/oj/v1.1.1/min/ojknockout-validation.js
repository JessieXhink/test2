/**
 * Copyright (c) 2014, 2015, Oracle and/or its affiliates.
 * All rights reserved.
 */
"use strict";
define(["ojs/ojcore","jquery","knockout","ojs/ojknockout","ojs/ojmessaging"],function(a,f,d){a.Db=function(){this.Init()};o_("InvalidComponentTracker",a.Db,a);a.b.ga(a.Db,a.b,"oj.InvalidComponentTracker");a.Db.uk="messagesShown";a.Db.cm="messagesHidden";a.Db.bm="disabled";a.Db.kt="readOnly";a.Db.prototype.Init=function(){a.Db.q.Init.call(this);this.Or=[];this.Am=[];this.jr=[];this.invalidHidden=this.invalidShown=!1};a.Db.prototype.WX=function(){var a=null,c=this,d=this.RA;this.invalidShown&&(a=this.HF());
setTimeout(function(){(a=d===c.RA?a||c.HF():c.HF())&&a.call(a,"Focus")},1);return a?!0:!1};a.b.i("InvalidComponentTracker.prototype.focusOnFirstInvalid",{WX:a.Db.prototype.WX});a.Db.prototype.showMessages=function(){var a,c,d;if(this.invalidHidden)for(c=this.jr.length,d=0;d<c;d++)this.jr[d]&&(a=this.Or[d].call(a,"showMessages"))};a.b.i("InvalidComponentTracker.prototype.showMessages",{showMessages:a.Db.prototype.showMessages});a.Db.prototype.HF=function(){for(var a,c=0,d=this.Am.length,c=0;c<d;c++)if(a=
this.Am[c])return this.Or[c];return null};a.Db.prototype.PH=function(a){var c=-1,d=!1;f.each(this.Or,function(d,e){0>c&&e===a&&(c=d)});0<=c&&(this.Or.splice(c,1),this.Am.splice(c,1),this.jr.splice(c,1),this.XI(),d=!0);return d};a.Db.prototype.Oj=function(b,c,d){var g=b.call(b,"isValid"),h=-1,k=!0,l;f.each(this.Or,function(a,c){0>h&&c===b&&(h=a)});switch(c){case a.Db.uk:case a.Db.cm:l=!1;d&&(0>h&&(h=this.Or.push(b)-1,this.N$(h,l)),!g&&a.Db.JG(d)&&(l=!0,c===a.Db.uk&&(d=b.call(b,"option",a.Db.bm),g=
b.call(b,"option",a.Db.kt),l=d||g?!1:!0)),k=this.Pv(c,h||0,l),this.XI(),k&&(void 0===this.RA&&(this.RA=0),this.RA++));break;case a.Db.bm:case a.Db.kt:k=!1,d&&(k=this.Pv(a.Db.uk,h||0,!1),k=this.Pv(a.Db.cm,h||0,!1)||k,this.XI())}return k};a.Db.prototype.N$=function(b,c){void 0===this.Am[b]&&this.Pv(a.Db.uk,b,c);void 0===this.jr[b]&&this.Pv(a.Db.cm,b,c)};a.Db.prototype.XI=function(){this.invalidShown=0<=this.Am.indexOf(!0);this.invalidHidden=0<=this.jr.indexOf(!0)};a.Db.prototype.Pv=function(b,c,d){var g=
!1;b=b===a.Db.uk?this.Am:b===a.Db.cm?this.jr:[];0<=c&&void 0!==b[c]?(g=b[c]!==d?!0:!1)&&b.splice(c,1,d):(b.push(d),g=!0);return g};a.Db.JG=function(b){return!a.X.isValid(b)};a.ub=function(){};a.ub.bt="invalidComponentTracker";a.ub.OM="ojoptionchange";a.ub.uk="messagesShown";a.ub.cm="messagesHidden";a.ub.bm="disabled";a.ub.kt="readOnly";a.ub.Oj=function(b,c,e,g,f){e={};f=f.call()[a.ub.bt];var k;if(b===a.ub.bm||b===a.ub.kt)return k=f&&f.peek()||null,null!==k&&d.isWriteableObservable(f)&&k.Oj.call(k,
g,b,c)&&f.valueHasMutated(),e[b]=c,e};a.ub._init=function(a,c){var d={};d[a]=c;return d};a.ub.U3=function(b,c,d,g){g=g.call();var f;b===a.ub.bt&&(f=g[b]?!0:!1)&&a.ub.fca(b,g,c,d);return{}};a.ub.q4=function(b,c,e,g){c=f(c);g=g.call()[b];b===a.ub.bt&&c&&(c.off(a.ub.OM,a.ub.WW),g&&d.isWriteableObservable(g)&&(b=g.peek(),b.PH.call(b,e)&&g.valueHasMutated()))};a.ub.WW=function(b,c){var e=b.data.hL,g,f=b.data.Aa,k=c.option,l=c.value;(k===a.ub.uk||k===a.ub.cm)&&e&&d.isWriteableObservable(e)&&(g=e.peek())&&
g.Oj.call(g,f,k,l)&&e.valueHasMutated()};a.ub.fca=function(b,c,e,g){b=c[b];var h,k;e=f(e);if(d.isObservable(b))k=b.peek(),null==k&&(k=new a.Db,b(k));else throw Error("Binding attribute "+a.ub.bt+" should be bound to a ko observable.");null!==k&&(d.isWriteableObservable(b)&&(c=g.call(g,"option",a.ub.uk),h=g.call(g,"option",a.ub.cm),k.Oj.call(k,g,a.ub.uk,c),k.Oj.call(k,g,a.ub.cm,h),b.valueHasMutated()),g={hL:b,Aa:g},e.on(a.ub.OM,g,a.ub.WW))};a.ia.Vj().dk({"for":"editableValue",attributes:[a.ub.bt,a.ub.bm,
a.ub.kt],init:a.ub._init,update:a.ub.Oj,afterCreate:a.ub.U3,beforeDestroy:a.ub.q4})});