/**
 * Copyright (c) 2014, Oracle and/or its affiliates.
 * All rights reserved.
 */
"use strict";
define(['./DvtToolkit'], function(dvt) {
  // Internal use only.  All APIs and functionality are subject to change at any time.
    // Map the D namespace to dvt, which is used to provide access across partitions.
  var D = dvt;
  D.iS=function(a,b,c){this.Init(a,b,c)};(0,D.ca)("DvtTagCloud",D.iS);D.y.q(D.iS,D.Fk,"DvtTagCloud");D.iS.newInstance=function(a,b,c){return new D.iS(a,b,c)};D.iS.prototype.Init=function(a,b,c){D.iS.u.Init.call(this,a,b,c);this.j().Uc.Fa().setAttributeNS(D.o,"text-rendering","geometricPrecision");this.eb=new D.jS(this,a,this.Wa,this);this.eb.Ne(this);(0,D.Ze)()||(0,D.Yl)(this.eb,new D.kS(this.eb));this.If=new D.lS;this.lb=[];this.cq=[]};
D.iS.prototype.U=function(a,b,c){!(0,window.isNaN)(b)&&!(0,window.isNaN)(c)&&(this.fb=b,this.tb=c);this.lN();this.Od(a);this.kb&&this.kb.stop();this.aj=this.da;this.dCa=this.lb;this.lb=[];this.oka=[];this.da=new D.C(this.j());this.k(this.da);D.mS.U(this,this.da,new D.B(0,0,this.fb,this.tb));b=this.G.animationDuration;c=new D.B(0,0,this.fb,this.tb);this.aj?"none"!==this.G.animationOnDataChange&&a&&(this.Jf=new D.C(this.j()),this.k(this.Jf),a=new D.fo(this.j(),this.Jf),(0,D.go)(a,this.dCa,this.lb),
this.kb=a.Er()):"none"!==this.G.animationOnDisplay&&(this.kb=D.em.DC(this.j(),D.em.Qx,this.da,c,b));this.kb?(this.eb.Vc(),this.eb.qm(this),this.kb.je(this.Lea,this),this.kb.play()):this.Lea();this.wo()};D.iS.prototype.render=D.iS.prototype.U;D.iS.prototype.Zf=function(){this.nk||(this.nk=new D.nS(this));return this.nk};D.iS.prototype.getAutomation=D.iS.prototype.Zf;D.iS.prototype.iD=function(a,b){this.cq.push(a);this.oka[b]=a};D.iS.prototype.bo=(0,D.w)("cq");D.iS.prototype.hn=(0,D.w)("oka");
D.iS.prototype.pf=function(a){this.G.highlightedCategories=D.vm.ia(a);(0,D.wm)(a,this.bo(),"any"===this.G.highlightMatch)};D.iS.prototype.highlight=D.iS.prototype.pf;D.iS.prototype.select=function(a){this.G.selection=D.vm.ia(a);this.Vt&&(0,D.Qm)(this.Vt,this.G.selection,this.bo())};D.iS.prototype.select=D.iS.prototype.select;D.x=D.iS.prototype;
D.x.Od=function(a){a?this.G=this.If.ej(a):this.G||(this.G=(0,D.Kk)(this));a=this.G.selectionMode;this.Vt="single"===a?new D.am("s"):"multiple"===a?new D.am("m"):D.o;this.eb.Mv(this.Vt);(0,D.$l)()||(this.G.animationOnDisplay="none",this.G.animationOnDataChange="none")};D.x.Lj=function(){return(0,D.Zl)(this.A(),"componentName","DvtUtilBundle","TAG_CLOUD")};
D.x.Lea=function(){this.aj&&(this.removeChild(this.aj),this.aj.aa(),this.aj=D.o);this.Jf&&(this.removeChild(this.Jf),this.Jf.aa(),this.Jf=D.o);this.kb&&(this.kb=D.o,this.eb.Ne(this));this.Vt&&(0,D.Qm)(this.Vt,this.G.selection,this.bo());this.G.highlightedCategories&&0<this.G.highlightedCategories.length&&this.pf(this.G.highlightedCategories)};D.x.lN=function(){this.eb.Vc();this.cq.length=0};D.x.Aa=(0,D.w)("eb");
D.nS=(0,D.v)("bv");(0,D.ca)("DvtTagCloudAutomation",D.nS);D.y.q(D.nS,D.Nk,"DvtTagCloudAutomation");D.nS.prototype.Jl=function(a){return(a=this.bv.eb.za(a))&&a instanceof D.oS?"item["+this.bv.hn().indexOf(a)+"]":D.o};D.nS.prototype.Cg=function(a){var b=a.indexOf("[");return 0<b&&"item"===a.substring(0,b)&&(a=(0,window.parseInt)(a.substring(b+1,a.length-1)),a=this.bv.hn()[a])?a.Qd()[0].Fa():D.o};D.nS.prototype.getDomElementForSubId=D.nS.prototype.Cg;
D.nS.prototype.getItem=function(a){if(a=this.bv.hn()[a]){var b={};b.color=a.kj();b.tooltip=a.fd();b.label=a.ed();b.value=a.getValue();b.selected=a.Ha();return b}return D.o};D.nS.prototype.getItem=D.nS.prototype.getItem;D.nS.prototype.nZ=function(){return this.bv.bo().length};D.nS.prototype.getItemCount=D.nS.prototype.nZ;
D.rS=function(a,b,c,d,e,f,g){this.Init(a,b,c,d,e,f,g)};D.y.q(D.rS,D.il,"DvtTagCloudItem");D.x=D.rS.prototype;D.x.Init=function(a,b,c,d,e,f,g){D.rS.u.Init.call(this,b,c,d,e,f,g);this.bv=a;f&&(0,D.sS)(this,f)};D.x.n0=function(a,b){this.GY();return D.rS.u.n0.call(this,a,b)};D.x.zb=function(a){this.yk!=a&&((this.yk=a)?this.Zp?this.Na(this.nW):this.Na(this.VX):this.Na(this.xF))};D.x.Sb=function(){this.Zp||(this.Zp=D.k,this.yk?this.Na(this.nW):this.Na(this.R5))};
D.x.Jb=function(){this.yk?this.Na(this.VX):this.Na(this.xF);this.Zp=D.p};
D.x.xf=function(a,b){var c=new D.yo(this.j(),this,D.tS.Pa(this.bv)),d=this.Bc(),e=b.Bc(),f=D.p,g=e.D("color"),h=d.D("color");if(g!=h){var j=this;this.Na(d.ca("color",g));(0,D.S)(c.P,"typeColor",this,function(){return j.Bc().D("color")},function(a){j.Na(j.Bc().ca("color",a))},h)}e=(0,window.parseFloat)(e.D("font-size"));d=(0,window.parseFloat)(d.D("font-size"));e!=d&&(f=D.k,j=this,this.qf(e),(0,D.S)(c.P,"typeNumber",this,function(){return(0,window.parseFloat)(j.Bc().D("font-size"))},this.qf,d));g=
b.pa();d=this.pa();e=b.ao();h=this.ao();if(d!=g||f&&h!=e)h!=e&&(f=g,g=b.Df.I(D.i),g="left"==e?f+g.e:"right"==e?f-g.e:f),this.ja(g),(0,D.S)(c.P,"typeNumber",this,this.pa,this.ja,d);f=b.qa();d=this.qa();d!=f&&(this.Ea(f),(0,D.S)(c.P,"typeNumber",this,this.qa,this.Ea,d));b.F(0);a.add(c,1)};D.x.Nh=function(a){a.add(new D.Ao(this.j(),this,D.tS.Pa(this.bv)),0)};D.x.Pg=function(a){this.F(0);a.add(new D.io(this.j(),this,D.tS.Pa(this.bv)),2)};D.x.qf=function(a){D.rS.u.qf.call(this,a);(0,D.sS)(this,this.Bc())};
D.sS=function(a,b){a.xF=b;var c=a.xF.D("color");a.xF.ca("background-color",D.o);a.R5=a.xF.ia();var d=(0,D.uS)(c,0.3);a.R5.ca("background-color",d);a.R5.ca("color",D.J.gk(d));a.VX=a.xF.ia();a.VX.ca("background-color",c);a.VX.ca("color",D.J.gk(c));a.nW=a.xF.ia();c=(0,D.uS)(c,0.6);a.nW.ca("background-color",c);a.nW.ca("color",D.J.gk(c))};
D.uS=function(a,b){var c=D.J.ue(a),d=D.J.qe(a),e=D.J.pe(a);return D.J.eD(window.Math.floor(255*(1-b)+b*c),window.Math.floor(255*(1-b)+b*d),window.Math.floor(255*(1-b)+b*e))};
D.oS=function(a,b,c){this.Init(a,b,c)};D.y.q(D.oS,D.y,"DvtTagCloudObjPeer");D.x=D.oS.prototype;D.x.Init=function(a,b,c){this.N=a;this.jh=b;this.va=c;this.rE=this.yk=D.p;c.url?(b.xd("link"),this.I6=D.G.GC("_blank",c.url)):b.xd("img");this.iq()};D.x.getId=function(){return this.va.id};D.x.ed=function(){return this.va.label};D.x.getValue=function(){return this.va.value};D.x.fd=function(){return this.va.shortDesc};D.x.Oe=function(){return this.va.action};
D.x.Pe=function(){var a=this.N.A().tooltip;return a?(0,D.kq)(this.N.j().qd(),a,this.kv()):this.fd()};D.x.kv=function(){return{id:this.getId(),label:this.ed(),color:this.kj(),value:this.getValue()}};D.x.GC=(0,D.w)("I6");D.x.kj=function(){this.In||(this.In=(new D.I(this.va.style)).D("color"));return this.In};D.x.rg=(0,D.v)("rE");D.x.bb=(0,D.w)("rE");D.x.Ha=(0,D.w)("yk");D.x.zb=function(a){this.yk=a;this.jh.zb(a);this.iq()};D.x.Sb=function(){this.jh.Sb()};D.x.Jb=function(){this.jh.Jb()};
D.x.Td=function(a){var b=this.N.eb.yh;return a.type==D.$e||b.Ht(a)?this:b.Rg(a)?(0,D.eP)(this,a,this.N.bo()):D.o};D.x.Ze=function(a){return this.jh.I(a)};D.x.Ej=function(){return this.jh.Fa()};D.x.ke=function(){this.Ub=D.k;this.Sb()};D.x.qc=function(){this.Ub&&(this.Ub=D.p,this.Jb())};D.x.Nc=(0,D.w)("Ub");D.x.Qd=function(){return[this.jh]};D.x.mc=function(){var a=[];this.bb()&&a.push((0,D.M)("DvtUtilBundle",this.Ha()?"STATE_SELECTED":"STATE_UNSELECTED"));return(0,D.ql)(this.fd(),a)};D.x.Xc=function(){return this.va.categories};
D.x.iq=function(){(0,D.Cf)()||this.jh.Wb("label",this.mc())};
D.lS=function(){this.Init({alta:D.pS})};D.y.q(D.lS,D.Vk,"DvtTagCloudDefaults");D.pS={animationOnDisplay:"none",animationOnDataChange:"none",emptyText:D.o,hiddenCategories:[],hideAndShowBehavior:"none",highlightedCategories:[],highlightMatch:"all",hoverBehavior:"none",layout:"rectangular",selectionMode:"none",styleDefaults:{animationDuration:500,hoverBehaviorDelay:200,style:"font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif; color: #333333;"}};
D.mS={};D.y.q(D.mS,D.y,"DvtTagCloudRenderer");D.mS.U=function(a,b,c){D.mS.TF(a,b,c);var d=a.A();d.items&&0<d.items.length?(d=D.mS.vDa(a,b,c),0<d.length?(a.lb=d,(0,D.sm)(a.eb,a.bo()[0])):D.mS.Zma(a,b,c)):D.mS.Zma(a,b,c)};D.mS.Zma=function(a,b,c){var d=a.A(),e=d.emptyText;e||(e=(0,D.Zl)(d,"labelNoData","DvtUtilBundle","NO_DATA",D.o));D.yf.sn(b,e,new D.B(c.x,c.y,c.e,c.g),a.eb,new D.I(d.styleDefaults.style))};D.mS.TF=function(a,b,c){a=new D.D(a.j(),c.x,c.y,c.e,c.g);(0,D.Aj)(a);b.k(a)};
D.mS.vDa=function(a,b,c){for(var d=a.A(),e=[],f=d.items,g=window.Number.MAX_VALUE,h=-window.Number.MAX_VALUE,j=0;j<f.length;j++)g=window.Math.min(g,f[j].value),h=window.Math.max(h,f[j].value);g=D.vS.uHa(g,h);h=D.Ag.XK(d.hiddenCategories);for(j=0;j<f.length;j++){var l=f[j];l.categories||(l.categories=[l.label]);if(!h||!D.Ag.CR(h,l.categories)){var m=new D.I(d.styleDefaults.style);(0,D.vg)(m,l.style);m.ca("font-size",g.call(D.o,l.value).toString());var m=new D.rS(a,a.j(),l.label,0,0,m,l.id),n=new D.oS(a,
m,l);a.eb.Ba(m,n);a.iD(n,j);"none"!==d.selectionMode&&n.rg(D.k);(n.bb()||l.url||n.Oe())&&m.setCursor("pointer");e.push(m);b.k(m)}}0<e.length&&("cloud"===d.layout?D.vS.xFa(c.e,c.g,e):D.vS.fLa(c.e,c.g,e,(0,D.F)(a.j())));return e};
D.vS=(0,D.s)();D.y.q(D.vS,D.y,"DvtTagCloudLayoutUtils");D.vS.uHa=function(a,b){return function(c){return 12+window.Math.ceil(12*(2*(c-a)/(b-a)))}};
D.vS.xFa=function(a,b,c){var d=[],e=10/180,f=10/180;a>b?e*=a/b:f*=b/a;for(var g=2*window.Math.PI/180,h=D.o,j=0,l=[],m=[],n=0;n<c.length;n++)for(var q=D.p,r=0,t=4,u=c[n],A=u.I(),j=window.Math.max(j,(0,window.parseFloat)(u.Bc().D("font-size"))),z=-1;!q;){var E=r%180;l[E]===D.i&&(l[E]=window.Math.cos(r*g));m[E]===D.i&&(m[E]=window.Math.sin(r*g));var U=e*r*l[E],L=f*r*m[E],O=new D.B(U,L,A.e,A.g),q=D.k;-1!=z&&d[z].Baa(O)&&(q=D.p);if(q)for(E=0;E<n;E++)if(d[E].Baa(O)){z=E;q=D.p;break}q&&(h=h?(0,D.Kp)(h,O):
O,z=-1,d[n]=O,u.ja(U),u.Ea(-A.y+L));3600===r?t=3:5400===r?t=2:10800===r&&(t=1);r+=t}d=window.Math.max(h.e/a,h.g/b);e=h.x+h.e/2;h=h.y+h.g/2;for(E=0;E<c.length;E++)u=c[E],u.ja(u.pa()/d+(a/2-e/d)),u.Ea(u.qa()/d+(b/2-h/d)),f=(0,window.parseFloat)(u.Bc().D("font-size")),u.qf(f/d)};
D.vS.fLa=function(a,b,c,d){for(var e=[],f=0,g=0,h=0,j=0;j<c.length;j++){var l=c[j],m=l.I(),f=window.Math.max(f,m.e),g=window.Math.max(g,m.g),h=window.Math.max(h,(0,window.parseFloat)(l.Bc().D("font-size")));e.push(new D.Ah(m.e,m.g))}j=0;for(l=(a-10)/f;0.001<l-j;)f=(j+l)/2,h=D.vS.tha(e,(a-10)/f),h.length*(f*g+2)-2>b-10?l=f:j=f;f=j;h=D.vS.tha(e,(a-10)/f);h.push(c.length);for(j=0;j<h.length-1;j++){b=h[j];var m=h[j+1],n=0,q=0,r=D.k;if(1<m-b){for(var l=0,t=b;t<m;t++)l+=e[t].e*f,q=window.Math.max(q,e[t].g*
f);n=(a-10-l)/(m-b-1);j==h.length-2&&(t=0.5*q,t<n&&l+(m-b)*t<0.9*(a-10)&&(n=t,r=D.p))}for(var q=5+(j+1)*(g*f+2)-2,u=d?a-5:5,t=b;t<m;t++){var l=c[t],A=(0,window.parseFloat)(l.Bc().D("font-size"));l.qf(A*f);l.Ea(q);r&&t==m-1&&t!=b?d?(l.Ci(),l.ja(5)):(l.Di(),l.ja(a-5)):(l.ja(u),d?(l.Di(),u-=e[t].e*f+n):(l.Ci(),u+=e[t].e*f+n))}}};D.vS.tha=function(a,b){var c=[0],d=a[0].e+2;if(1<a.length)for(var e=1;e<a.length;e++)d+a[e].e>b&&(c.push(e),d=0),d+=a[e].e+2;return c};
D.tS={};D.y.q(D.tS,D.y,"DvtTagCloudStyleUtils");D.tS.Pa=function(a){return a.A().styleDefaults.animationDuration/1E3};
D.jS=function(a,b,c,d){this.Init(b,c,d);this.N=a};D.y.q(D.jS,D.Xk,"DvtTagCloudEventManager");D.jS.prototype.SM=function(a){a=this.za(a.target);(0,D.qS)(a);this.bn(a)};D.jS.prototype.xT=function(a){a=this.za(a.target);this.bn(a)};D.jS.prototype.Rt=function(a){a=this.za(a.target);(0,D.qS)(a);this.bn(a)};D.qS=function(a){a instanceof D.oS&&(a=a.GC())&&a.call()};D.jS.prototype.rj=function(a){var b=D.k,c=this.Jd();13==a.keyCode?(0,D.qS)(c):b=D.jS.u.rj.call(this,a);return b};
D.jS.prototype.Gp=function(a,b,c){var d=this.N.A();"dim"==d.hoverBehavior&&(b=b.Xc?b.Xc():[],d.highlightedCategories=c?b.slice():D.o,c=new D.Kn(c?"categoryRollOver":"categoryRollOut",d.highlightedCategories),b=(0,D.jq)(d.styleDefaults.hoverBehaviorDelay),this.PA.ze(c,this.N.bo(),b,"any"==d.highlightMatch),a.stopPropagation())};D.jS.prototype.bn=function(a){a&&(a.Oe&&a.Oe())&&this.gh(new D.bl("action",a.Oe(),a.getId()))};
D.kS=function(a){this.Init(a)};D.y.q(D.kS,D.On,"DvtTagCloudKeyboardHandler");D.kS.prototype.Init=function(a){D.kS.u.Init.call(this,a)};D.kS.prototype.cA=function(a){return this.Rg(a)&&!a.ctrlKey};D.kS.prototype.Ht=function(a){return 32==a.keyCode&&a.ctrlKey};D.eP=function(a,b,c){a=c.indexOf(a)+(39==b.keyCode||40==b.keyCode?1:-1);return a<c.length&&0<=a?c[a]:D.o};
  return D;
});