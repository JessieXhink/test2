/**
 * Copyright (c) 2014, 2015, Oracle and/or its affiliates.
 * All rights reserved.
 */
"use strict";
/*
 Copyright 2013 jQuery Foundation and other contributors
 Released under the MIT license.
 http://jquery.org/license
*/
define(["ojs/ojcore","jquery","ojs/ojcomponentcore"],function(a,f){(function(){var d=0;a.Da("oj.ojCollapsible",f.oj.baseComponent,{widgetEventPrefix:"oj",options:{expanded:!1,disabled:null,expandOn:"click",expandArea:"disclosureIcon",beforeExpand:null,expand:null,beforeCollapse:null,collapse:null,optionChange:null},_ComponentCreate:function(){this._super();this.element.addClass("oj-collapsible oj-component");this.vU();this.Ad();this.wg=!0;var a=this.element[0];this.hF({type:this.options.expanded?
"ojexpand":"ojcollapse",target:a,currentTarget:a,preventDefault:f.noop});this.wg=void 0},Xe:function(a,c,d){this.Ye(c,d,{launcher:this.element.find(".oj-collapsible-header-icon").first()})},z5:function(){var a=this.options.expanded?"oj-collapsible-open-icon":"oj-collapsible-close-icon";(this.Mh()?f("\x3cspan\x3e"):f("\x3ca href\x3d'#'\x3e")).addClass("oj-component-icon oj-clickable-icon-nocontext oj-collapsible-header-icon "+a).attr("aria-labelledby",this.header.attr("id")).prependTo(this.header)},
YP:function(){this.header.children(".oj-collapsible-header-icon").remove()},_destroy:function(){this.aP();this.element.removeClass("oj-collapsible oj-component oj-expanded oj-collapsed oj-disabled");this.Mh()&&this.mF(this.header).removeAttr("tabIndex");this.header.removeClass("oj-collapsible-header").each(function(){/^oj-collapsible/.test(this.id)&&this.removeAttribute("id")});this.bu().removeAttr("role").removeAttr("aria-controls").removeAttr("aria-expanded").removeAttr("aria-disabled");this.YP();
this.content.css("display","").removeAttr("aria-hidden").removeAttr("tabIndex").removeClass("oj-component-content oj-collapsible-content").each(function(){/^oj-collapsible/.test(this.id)&&this.removeAttribute("id")})},aP:function(){this.Lr();this.content&&(a.C.unwrap(this.content),this.ik=null)},Mh:function(){return this.element.hasClass("oj-disabled")},hR:function(){return"header"==this.options.expandArea?"\x3e .oj-collapsible-header":"\x3e .oj-collapsible-header \x3e .oj-collapsible-header-icon"},
_setOption:function(a,c,d){"expanded"===a?c!==this.options.expanded&&this.bda(c):"disabled"===a?(this.header.add(this.header.next()),this.element.toggleClass("oj-disabled",!!c)):"expandOn"===a||"expandArea"===a?(this.Lr(),this._super(a,c,d),this.Li()):this._super(a,c,d)},Mo:function(a){if(!a.altKey&&!a.ctrlKey){var c=f.ui.keyCode;switch(a.keyCode){case c.SPACE:case c.ENTER:this.OW(a)}}},refresh:function(){this._super();this.aP();this.vU();this.YP();this.Ad()},vU:function(){this.header=this.element.children(":first-child").addClass("oj-collapsible-header");
this.content=this.header.next().addClass("oj-collapsible-content oj-component-content");this.content.wrap("\x3cdiv\x3e\x3c/div\x3e");this.ik=this.content.parent().addClass("oj-collapsible-wrapper");this.options.disabled&&this.element.addClass("oj-disabled");this.Mh()&&this.mF(this.header).attr("tabIndex",-1)},Ad:function(){var a=this.header,c=this.content,e=this.options,f="oj-collapsible-"+(this.element.attr("id")||++d),h=a.attr("id"),k=c.attr("id");h||a.attr("id",f+"-header");k||(k=f+"-content",
c.attr("id",k));this.z5();a=this.bu();a.attr("role","button").attr("aria-controls",k).attr("aria-expanded",e.expanded);this.Mh()&&a.attr("aria-disabled","true");e.expanded?c.removeAttr("aria-hidden"):(this.ik.css({"max-height":0,"overflow-y":"hidden",display:"none"}),this.ik.css("max-height",0),c.attr("aria-hidden","true"));this.Li()},bda:function(a){a?this.expand(!0):this.collapse(!0)},Li:function(){var b={keydown:this.Mo},c=this.options.expandOn;if(c){var d=this;f.each(c.split(" "),function(c,f){a.C.BB(f)&&
(b[f]=d.OW)})}c=this.element.find(this.hR());this._on(c,b);this._on(this.ik,{transitionend:this.Qr,webkitTransitionEnd:this.Qr,otransitionend:this.Qr,oTransitionEnd:this.Qr});this.Mh()||(this._on(this.element,{ojexpand:this.hF,ojcollapse:this.hF,ojfocus:this.LQ,ojfocusout:this.LQ}),this._hoverable(c),this._focusable(c),this.Bt(c))},Lr:function(){this._off(this.element.find(this.hR()));this.ik&&this._off(this.ik);this._off(this.element.add(this.content))},OW:function(a){this.Mh()||(this.options.expanded?
this.collapse(!0,a):this.expand(!0,a),a.preventDefault(),a.stopPropagation(),this.header.find(".oj-collapsible-header-icon").focus())},hF:function(b){if(!this.Mh()&&b.target===this.element[0]&&(this.wg||!b.isDefaultPrevented())){var c=this.element,d=this.options,f=this.content,h=this.ik,k="ojexpand"===b.type;b.preventDefault();this.wg?(d.expanded=k)?(c.removeClass("oj-collapsed"),c.addClass("oj-expanded"),a.Components.Il(h[0])):(c.removeClass("oj-expanded"),c.addClass("oj-collapsed"),h.css("max-height",
0),h.hide(),a.Components.Cn(h[0])):(this.M4(k,b),h.hB=h.outerHeight(),k?(h.show(),setTimeout(function(){h.hB+=f.outerHeight();h.addClass("oj-collapsible-transition").css({"max-height":h.hB});c.removeClass("oj-collapsed");c.addClass("oj-expanded");a.Components.Il(h[0])},1)):(h.removeClass("oj-collapsible-transition"),h.css({"max-height":h.hB,"overflow-y":"hidden"}),setTimeout(function(){h.addClass("oj-collapsible-transition").css({"max-height":0});c.removeClass("oj-expanded");c.addClass("oj-collapsed");
a.Components.Cn(h[0])},10)));this.header.find(".oj-collapsible-header-icon").toggleClass("oj-collapsible-open-icon",k).toggleClass("oj-collapsible-close-icon",!k||!1).end();k?this.content.removeAttr("aria-hidden"):this.content.attr("aria-hidden","true");this.bu().attr("aria-expanded",k)}},LQ:function(a){if(this.Mh())return null;"ojfocusout"==a.type?(this.bu().attr("tabIndex",-1),a.preventDefault(),a.stopPropagation()):"ojfocus"==a.type&&(this.bu().attr("tabIndex",0).focus(),a.preventDefault(),a.stopPropagation())},
bu:function(){return this.mF(this.header).first()},mF:function(a){return this.Mh()?a.find("span"):a.find("a,:input")},expand:function(a,c){if(!this.Mh()){var d={header:this.header,content:this.content};a&&!1===this._trigger("beforeExpand",c,d)||this._trigger("expand",c,d)}},collapse:function(a,c){if(!this.Mh()){var d={header:this.header,content:this.content};a&&!1===this._trigger("beforeCollapse",c,d)||this._trigger("collapse",c,d)}},Qr:function(a){this.Mh()||("max-height"==(a.originalEvent?a.originalEvent.propertyName:
null)&&(a.preventDefault(),a.stopPropagation()),this.options.expanded?this.ik.css({"max-height":9999,"overflow-y":""}):this.ik.hide(),this.ik.removeClass("oj-collapsible-transition"))},M4:function(a,c){this.option("expanded",a,{_context:{originalEvent:c,rd:!0,mb:!0}})},getNodeBySubId:function(a){if(null==a)return this.element?this.element[0]:null;a=a.subId;switch(a){case "oj-collapsible-content":return this.content[0];case "oj-collapsible-header":return this.header[0];case "oj-collapsible-header-icon":return this.header.find("."+
a)[0]}return null}})})()});