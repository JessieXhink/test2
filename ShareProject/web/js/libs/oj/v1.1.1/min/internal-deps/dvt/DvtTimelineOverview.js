/**
 * Copyright (c) 2014, Oracle and/or its affiliates.
 * All rights reserved.
 */
"use strict";
define(['./DvtToolkit', './DvtOverview'], function(dvt) {
  // Internal use only.  All APIs and functionality are subject to change at any time.
    // Map the D namespace to dvt, which is used to provide access across partitions.
  var D = dvt;
  D.jU=function(a,b,c){this.Init(a,b,c)};(0,D.ca)("DvtTimelineOverview",D.jU);D.y.q(D.jU,D.Gp,"DvtTimelineOverview");D.jU.prototype.Init=function(a,b,c){D.jU.u.Init.call(this,a,b,c);a=[D.J.LC(D.J.hm("#aadd77",0.35)),"#aadd77",D.J.LC(D.J.en("#aadd77",0.5))];D.hP.Hl()&&(a=["#aadd77"]);this.I4=a;this.ila=(0,D.kp)();this.Rs=12};D.jU.prototype.tqa=function(){return new D.HU(this)};
D.jU.prototype.nw=function(a){D.jU.u.nw.call(this,a);this.hq=a.sS;this.hz=a.LKa;this.XX=a.BLa;this.J4=a.Xoa;this.X4="#267DB3 #68C182 #FAD55C #ED6647 #8561C8 #6DDBDB #FFB54D #E371B2 #47BDEF #A2BF39 #A75DBA #F7F37B".split(" ");a="solid"==this.D("_","bs")?(0,window.parseInt)(this.D("_","bof"),10):1;var b="solid"==this.D("_as","bs")?(0,window.parseInt)(this.D("_as","bof"),10):1,c="solid"==this.D("_s","bs")?(0,window.parseInt)(this.D("_s","bof"),10):1;this.TW="none"!=this.hq?window.Math.max(b,c,a,1)/2+
1:1;this.fO=this.Oc()?0:0.75;this.kia=[this.fO,this.fO,this.fO];this.WCa=new D.Ug(250,this.I4,this.kia);this.DBa=new D.Ug(180,this.I4,this.kia);a=this.Oc()?0:1;this.Dya=new D.Wg("#aadd77",a)};D.IU=function(a,b){for(var c="_mrk_"+b,d="_drn_"+b,e=a.Ma(),f=0;f<e;f++){var g=a.na(f);if(g!=D.o&&(c==g.getId()||d==g.getId()))return g}return D.o};D.x=D.jU.prototype;D.x.BG=function(a){return a.getId().substr(5)};D.x.D=function(a,b){return this.Fya[a+b]};D.x.pa=function(a){return a.Pb!=D.o?a.Pb.pa():a.Da().Vb};
D.x.qa=function(a){return a.Pb!=D.o?a.Pb.qa():a.Da().Qb};D.x.Jc=function(a){a=a.Jc();a==D.o&&(a=this.Oc()?(this.fb-this.vR()-4)/2:1);return a};D.x.Kc=function(a){a=a.Kc();a==D.o&&(a=1);return a};
D.x.jS=function(a,b){D.jU.u.jS.call(this,a,b);if(this.hz!=D.o){for(var c=(0,D.JU)(this,this.rb,this.Yb,a,b,this.Rs),d=[],e=0;e<this.hz.length;e++){var f=this.hz[e];f.wk==D.o?this.G9(f,c):d[d.length]=f}this.C_(d);e=this.j();for(f=this.Y6;0<f;f--)for(var g=0;g<d.length;g++){var h=d[g];if(f==h.zs){var j=D.hP.be(this.rb,this.Yb,h.getTime(),this.Oc()?this.tb:this.fb),l="_drn_"+h.getId(),m=9+5*h.zs,n=D.hP.be(this.rb,this.Yb,h.wk,this.Oc()?this.tb:this.fb),j=this.Oc()?new D.D(e,this.fb-m,j,m,n-j,l):this.Rb()?
new D.D(e,this.fb-n,this.tb-m-20,n-j,m,l):new D.D(e,j,this.tb-m-20,n-j,m,l);j.O(new D.Mo(h.Oy));l=new D.Wg(this.D("_","dbc"),1,1);j.ea(l);(0,D.Ij)(j);j.Pb=h;this.k(j);h.W4=j;h.PNa=m-2}}this.removeChild(this.Una);this.k(this.Una);this.Rs=c}};
D.x.C_=function(a){this.Y6=0;var b=D.o;this.RI==D.o&&(this.RI={});for(var c=0;c<a.length;c++){var d=a[c],e=d.getId(),f=e.substring(e.indexOf(":")+1,e.length),f=f.substring(0,f.indexOf(":"));f!=b&&(this.ww=0,b=f);d.zs=(0,D.KU)(this,d,a);d.Oy==D.o&&(this.RI[e]==D.o?(this.RI[e]=this.ww,d.Oy=this.X4[this.ww],this.ww++,this.ww==this.X4.length&&(this.ww=0)):d.Oy=this.X4[this.RI[e]])}};D.x.qHa=function(){return this.RI?this.RI:D.o};D.jU.prototype.getDurationColorMap=D.jU.prototype.qHa;
D.JU=function(a,b,c,d,e,f){for(var g,h,j={max:1,I9:[]},l=a.Oc()?e:d,m=0;m<a.hz.length;m++){var n=a.hz[m];if(n.wk!=D.o){var q=D.hP.be(b,c,n.getTime(),l);!a.Oc()&&a.Rb()&&(q=l-q);n.ja(q)}else{var q=a,r=b,t=c,u=l,A=f/2,z=j,E=e,U=A*q.Jc(n)+q.TW,L=A*q.Kc(n)+q.TW,r=D.hP.be(r,t,n.getTime(),u);q.Rb()&&(r=u-r-2*U);if(q.Oc())A=0,"solid"==q.D("_","bs")&&(A=(0,window.parseInt)(q.D("_","bw"),10)),u=q.fb-2*q.Jc(n)-A-4;else for(var u=3,O=0,t=0;1>t;){g=q;h=z;var Z=n.yb(),W=r,ia=u,sa=U,Va=L,Na=A,gb=E;"above"==g.pX&&
(ia+=(0,D.tP)(g));for(var wb=0;wb<h.I9.length;wb++){var qb=h.I9[wb],xb=qb.pa(),bc=qb.qa(),yb=qb.yb(),Xh=g.Jc(qb),qb=g.Kc(qb),xb=window.Math.abs(W-xb),lf=Na*Xh+g.TW+sa;if(!(xb>=lf)&&(yb="circle"==Z&&"circle"==yb&&sa==Va&&Xh==qb?window.Math.sqrt(lf*lf-xb*xb):Na*qb+g.TW+Va,yb>window.Math.abs(ia-bc)&&(ia=bc+yb,O=window.Math.max(O,ia+yb),1<=Na&&gb!=D.i&&O>gb)))break}g=ia;h=O;g==u&&(t=1);O=h;u=g;t++}n.ja(r);n.Ea(u);z.I9.push(n);O>z.max&&(z.max=O);if(j.max>e)break}}return j.max>e&&1<f?(0,D.JU)(a,b,c,d,e,
f-1):f};
D.jU.prototype.G9=function(a,b){var c="_mrk_"+a.getId(),d=a.Ib(),e=a.H5,f=a.V$();f==D.o&&(f=this.fO,0==f&&d!=D.o&&(f=1));var g=this.Jc(a),h=this.Kc(a),j=a.yb();this.Oc()?(j="square",c=new D.bi(this.j(),j,D.o,a.qa(),a.pa(),2,2,c,g,h)):c=new D.bi(this.j(),j,D.o,a.pa(),a.qa(),b,b,c,g,h);c.Pb=a;d==D.o&&f==this.fO&&e==D.o?(e="circle"==j?this.WCa:this.DBa,d=this.Dya):(g=this.I4,d!=D.o&&(D.hP.Hl()?g=[d]:(g=D.J.hm(d,0.5),h=D.J.en(d,0.5),g=[g,d,h])),h=[f,f,f],e=e==D.o?"circle"==j?new D.Ug(250,g,h):new D.Ug(180,
g,h):new D.Mo(d,h[0]),d=new D.Wg(d,f));c.O(e);c.ea(d);"none"!=this.hq&&c.rg(D.k);d=this.Ma();f=this.na(d-1);d>this.aq&&("tb"==f.getId()||"arr"==f.getId())?this.Ua(c,d-this.aq):this.k(c);a.dg(c);this.Yn(c,"_");(this.Oc()||"square"==j||"diamond"==j||"triangleUp"==j||"triangleDown"==j||"plus"==j)&&"false"!=this.J4.pba&&(0,D.Ij)(c);return c};
D.KU=function(a,b,c){var d=c.length,e=b.getTime(),f=b.zs;f==D.o&&(f=1);for(var g=0;g<d;g++){var h=c[g];if(h!=b){var j=h.wk;if(j!=D.o){var l=h.getTime(),h=h.zs;h==D.o&&(h=1);e>=l&&(e<=j&&f==h)&&(f=h+1,b.zs=f,f=(0,D.KU)(a,b,c))}}}f>a.Y6&&(a.Y6=f);return f};
D.jU.prototype.tT=function(a){var b=D.jU.u.tT.call(this,a);if(b!=D.o){if(b.Pb!=D.o){var c=b.Pb.hO;c!=D.o&&this.j().qd().jM(a.pageX,a.pageY,c,"#000000");this.SG()&&this.setCursor("pointer")}if("none"!=this.hq){a=D.p;if(this.ak!=D.o)for(c=0;c<this.ak.length;c++)if(b==this.ak[c]){a=D.k;break}a||(a=this.BG(b),c=new D.LU("highlight"),(0,D.Km)(c,"itemId",a),this.dispatchEvent(c),(0,D.MU)(this,b))}}};
D.jU.prototype.sT=function(a){a=D.jU.u.sT.call(this,a);if(a!=D.o&&!(0,D.GP)(a)){this.j().qd().Vc();var b=D.p;if(this.ak!=D.o)for(var c=0;c<this.ak.length;c++)if(a==this.ak[c]){b=D.k;break}b||(b=this.BG(a),c=new D.LU("unhighlight"),(0,D.Km)(c,"itemId",b),this.dispatchEvent(c),(0,D.NU)(this,a))}};
D.jU.prototype.KD=function(a,b,c){b=D.jU.u.KD.call(this,a,b,c);if(b!=D.o&&(a=a.ctrlKey||a.shiftKey||(0,D.Ze)(),"none"!=this.hq)){c=this.BG(b);var d=new D.LU("selection");(0,D.Km)(d,"itemId",c);(0,D.Km)(d,"multiSelect",a);this.dispatchEvent(d);a=b.Pb.getTime();a!=D.o&&(c=new D.LU("scrollTime"),c.setTime(a),this.dispatchEvent(c),a=this.na(1),b=this.Oc()?this.pa(b)-a.getHeight()/2:this.pa(b)-a.getWidth()/2,(0,D.vP)(this,b))}};
D.MU=function(a,b){if(a.ak!=D.o)for(var c=0;c<a.ak.length;c++)if(b==a.ak[c])return;a.Yn(b,"_h")};D.NU=function(a,b){if(a.ak!=D.o)for(var c=0;c<a.ak.length;c++)if(b==a.ak[c])return;a.Yn(b,"_")};
D.jU.prototype.Yn=function(a,b){if(a instanceof D.bi){var c=D.p,d=D.p;if("solid"==this.D(b,"bs")){var c=D.k,e=this.D(b,"bc");e==D.o&&(e="#000000");var f=this.D(b,"gc");f!=D.o&&"none"!=f&&(d=D.k)}var g=a.kha,h=a.F5;!c&&g!=D.o?(this.removeChild(g),a.kha=D.o,h!=D.o&&(this.removeChild(h),a.F5=D.o)):!d&&h!=D.o&&(this.removeChild(h),a.F5=D.o);var j=a.$a();if(c){var c=(0,window.parseInt)(this.D(b,"bw"),10),l=(0,window.parseInt)(this.D(b,"bof"),10);g==D.o&&("circle"==j?(this.SG()&&(l=0),g=new D.bi(this.j(),
j,D.o,this.pa(a)-l,this.qa(a)-l,a.I().e+2*l,a.I().g+2*l,a.getId()+"_border",a.Jc(),a.Kc())):g=this.Oc()?new D.bi(this.j(),j,D.o,this.qa(a)-(c+1)/2,this.pa(a)-(c+1)/2,a.I().e+(c+1),a.I().g+(c+1),a.getId()+"_border",a.Jc(),a.Kc()):new D.bi(this.j(),j,D.o,this.pa(a)-l,this.qa(a)-l,a.I().e+2*l,a.I().g+2*l,a.getId()+"_border",a.Jc(),a.Kc()),this.Ua(g,this.Pf(a)),a.kha=g,g.O(this.ila));e=new D.Wg(e,this.D(b,"bo"),c);g.ea(e);(this.Oc()||"square"==j||"diamond"==j||"triangleUp"==j||"triangleDown"==j||"plus"==
j)&&"false"!=this.J4.pba&&(0,D.Ij)(g);d&&(h==D.o&&(h=l-c,"circle"==j?(this.SG()&&(h=0),h=new D.bi(this.j(),j,D.o,this.pa(a)-h,this.qa(a)-h,a.I().e+2*h,a.I().g+2*h,a.getId()+"_glow",a.Jc(),a.Kc())):h=this.Oc()?new D.bi(this.j(),j,D.o,this.qa(a),this.pa(a)-1,a.I().e+3,a.I().g+3,a.getId()+"_glow",a.Jc(),a.Kc()):new D.bi(this.j(),j,D.o,this.pa(a)-h,this.qa(a)-h,a.I().e+2*h,a.I().g+2*h,a.getId()+"_glow",a.Jc(),a.Kc()),this.Ua(h,this.Pf(g)),a.F5=h,h.O(this.ila)),f=new D.Wg(f,this.D(b,"go"),4),h.ea(f),(this.Oc()||
"square"==j||"diamond"==j||"triangleUp"==j||"triangleDown"==j||"plus"==j)&&"false"!=this.J4.pba&&(0,D.Ij)(h))}}else if((j=a.getId())&&"_drn_"==j.substring(0,5))j=this.D(b,"dbc"),j==D.o&&(j="#000000"),f=(0,window.parseInt)(this.D(b,"dbw"),10),a.ea(new D.Wg(j,1,f))};D.jU.prototype.Zf=function(){this.Lfa||(this.Lfa=new D.OU(this));return this.Lfa};D.jU.prototype.getAutomation=D.jU.prototype.Zf;
D.HU=function(a){this.Init(a)};D.y.q(D.HU,D.y,"DvtTimelineOverviewParser");D.x=D.HU.prototype;D.x.Init=function(a){this.N=a;this.Qu=new D.zk};D.x.parse=function(a){var b=this.Qu.parse(a);a=this.$x(b);var b=b.Mc(),c;if(c=b[0]){var d={};d.width=c.B("width");d.height=c.B("height");d.$La=c.Mc();c=d}else c=D.o;a.vsa=c;a.LKa=this.L7(b[1],a.Xoa);2<b.length&&(a.wGa=!b[2]?D.o:b[2].Mc());return a};
D.x.$x=function(a){var b={};b.start=(0,window.parseInt)(a.B("start"));b.end=(0,window.parseInt)(a.B("end"));b.width=(0,window.parseInt)(a.B("width"));b.Hba=(0,window.parseInt)(a.B("renstart"));b.currentTime=(0,window.parseInt)(a.B("ocd"));b.orientation=a.B("orn");b.Sra=a.B("ovp");b.sS=a.B("selmode");b.Laa=a.B("rtl");b.borderTopStyle=a.B("_bts");b.borderTopColor=a.B("_btc");b.BLa=a.B("sid");b.uoa=a.B("_aoc");var c={};c.shape=a.B("_ds");c.iH=a.B("_dsx");c.jH=a.B("_dsy");c.opacity=a.B("_do");c.color=
a.B("_fc");c.pba=a.B("_ph");b.Xoa=c;b.saa=a.B("_hfc");b.uaa=a.B("_htc");b.Jqa=a.B("_hbi");b.Vqa=a.B("_hw");b.Sqa=a.B("_hh");b.ica=a.B("_wbc");b.qca=a.B("_wbts");b.oca=a.B("_wbrs");b.kca=a.B("_wbbs");b.mca=a.B("_wbls");b.pca=a.B("_wbtc");b.nca=a.B("_wbrc");b.jca=a.B("_wbbc");b.lca=a.B("_wblc");b.kba=a.B("_obc");b.W9=a.B("_ctic");b.bca=a.B("_tic");b.tsa=a.B("_tabc");b.usa=a.B("_tabo");c={};c._bs=a.B("_bs");c._bc=a.B("_bc");c._bw=a.B("_bw");c._bof=a.B("_bof");c._bo=a.B("_bo");c._gc=a.B("_gc");c._go=
a.B("_go");c._dbs=a.B("_dbs");c._dbc=a.B("_dbc");c._dbw=a.B("_dbw");c._hbs=a.B("_hbs");c._hbc=a.B("_hbc");c._hbw=a.B("_hbw");c._hbof=a.B("_hbof");c._hbo=a.B("_hbo");c._hgc=a.B("_hgc");c._hgo=a.B("_hgo");c._hdbs=a.B("_hdbs");c._hdbc=a.B("_hdbc");c._hdbw=a.B("_hdbw");c._sbs=a.B("_sbs");c._sbc=a.B("_sbc");c._sbw=a.B("_sbw");c._sbof=a.B("_sbof");c._sbo=a.B("_sbo");c._sgc=a.B("_sgc");c._sgo=a.B("_sgo");c._sdbs=a.B("_sdbs");c._sdbc=a.B("_sdbc");c._sdbw=a.B("_sdbw");c._asbs=a.B("_asbs");c._asbc=a.B("_asbc");
c._asbw=a.B("_asbw");c._asbof=a.B("_asbof");c._asbo=a.B("_asbo");c._asgc=a.B("_asgc");c._asgo=a.B("_asgo");c._asdbs=a.B("_asdbs");c._asdbc=a.B("_asdbc");c._asdbw=a.B("_asdbw");b.mFa=c;return b};D.x.L7=function(a,b){if(!a)return D.o;for(var c=[],d=a.Mc(),e=0;e<d.length;e++){var f=this.P1(d[e],b),f=new D.PU(this.N,f);c.push(f)}return c};
D.x.P1=function(a,b){var c={},d="true"==a.B("_sd");c.id=a.B("tid");c.XL=a.B("rk");c.time=a.B("t");c.pG=a.B("et");c.shape=a.B("s");d&&c.shape==D.o&&(c.shape=b.shape);c.Z9=a.B("d");c.color=a.B("c");c.TY=a.B("dfc");d&&c.color==D.o&&(c.color=b.color);c.iH=a.B("sx");d&&c.iH==D.o&&(c.iH=b.iH);c.jH=a.B("sy");d&&c.jH==D.o&&(c.jH=b.jH);c.bJa=a.B("g");c.opacity=a.B("o");d&&c.opacity==D.o&&(c.opacity=b.opacity);return c};
D.PU=function(a,b){this.Init(a,b)};D.y.q(D.PU,D.y,"DvtTimelineOverviewNode");D.x=D.PU.prototype;
D.x.Init=function(a,b){this.N=a;this.$P=b.XL;this.jb=b.id;this.uEa=(0,window.parseInt)(b.time);this.wk=b.pG==D.o?D.o:(0,window.parseInt)(b.pG);this.J="circle";"square"==b.shape?this.J="square":"plus"==b.shape?this.J="plus":"diamond"==b.shape?this.J="diamond":"triangleUp"==b.shape?this.J="triangleUp":"triangleDown"==b.shape&&(this.J="triangleDown");this.hO=b.Z9;this.Tj=b.color;this.H5=b.bJa;b.opacity!=D.o&&(this.sCa=(0,window.parseFloat)(b.opacity));b.iH!=D.o&&(this.YDa=(0,window.parseFloat)(b.iH));
b.jH!=D.o&&(this.ZDa=(0,window.parseFloat)(b.jH));b.TY!=D.o&&(this.Oy=b.TY)};D.x.getId=(0,D.w)("jb");D.x.Z$=(0,D.w)("$P");D.x.getTime=(0,D.w)("uEa");D.x.Jc=(0,D.w)("YDa");D.x.Kc=(0,D.w)("ZDa");D.x.Ib=(0,D.w)("Tj");D.x.yb=(0,D.w)("J");D.x.V$=(0,D.w)("sCa");D.x.ya=(0,D.w)("jh");D.x.dg=(0,D.v)("jh");D.x.pa=(0,D.w)("Db");D.x.ja=(0,D.v)("Db");D.x.qa=(0,D.w)("Zb");D.x.Ea=(0,D.v)("Zb");
D.LU=function(a){this.Init("timeline");this.bm=a};D.y.q(D.LU,D.JP,"DvtTimelineOverviewEvent");D.LU.prototype.BG=function(){return this.Ii("itemId")};
D.OU=function(a){this.cc(a)};D.y.q(D.OU,D.Nk,"DvtTimelineOverviewAutomation");D.OU.prototype.cc=(0,D.v)("sc");
D.OU.prototype.Jl=function(a){var b=a.getId();if(a instanceof D.bi){a=b.split(":");if(4!=a.length)return D.o;b=this.sc.XX==D.o?D.o:this.sc.XX.split(" ");if(b!=D.o&&(b=b.indexOf(a[1]),-1<b))return"marker["+b+"]["+a[2]+"]"}else{if("window"==b)return"range_window";if("lh"==b||"lhb"==b||"lbgrh"==b)return"range_start_handle";if("rh"==b||"rhb"==b||"rbgrh"==b)return"range_end_handle";if("grpy"==b)return a=a.getParent().VQ(a),this.Jl(a)}return D.o};
D.OU.prototype.Cg=function(a){for(var b=a.split("["),c=b.length,d=1;d<c;d++){var e=b[d],e=e.substr(0,e.length-1),f=(0,window.parseFloat)(e),e=(0,window.isNaN)(f)?e:f;b[d]=e}if(b&&3==b.length&&"marker"==b[0]){if(c=this.sc.XX==D.o?D.o:this.sc.XX.split(" "),c!=D.o&&(d=(0,window.parseInt)(b[1],10),-1<d&&d<c.length)){a:{a=this.sc.hz;b="tl1:"+c[d]+":"+b[2]+":";for(c=0;c<a.length;c++)if(d=a[c],e=d.getId(),e!=D.o&&0==e.indexOf(b)){b=d;break a}b=D.o}return b?b.ya().Fa():D.o}}else{if("range_window"==a)return this.sc.na(1).Fa();
if("range_start_handle"==a)return this.sc.na(this.sc.Ma()-this.sc.aq).Fa();if("range_end_handle"==a)return(0,D.DP)(this.sc).Fa()}return D.o};(0,D.ca)("DvtTimelineOverviewAutomation.prototype.getDomElementForSubId",D.OU.prototype.Cg);
  return D;
});